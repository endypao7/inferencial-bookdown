# Distribuciones Muestrales

En esta sección exploraremos las principales distribuciones de probabilidad utilizadas en estadistica, su interpretacion, su aplicacion en R y la manera en que pueden ser visualizadas. 


## Estadísticos:
Con estos ejercicios vamos a simular que calculamos estadísticos para algunas variables.

### Datos númericos (media, varianza y desviación estándar)

Crear una secuencia de datos numéricos
```{r}
x <- seq(1, 5, length = 100) #Crear un vector 100 números desde el 1 hasta el 5
x
```

**Media**
```{r}
mean(x)
```

**Desviación estándar**
```{r}
sd(x)
```

### Datos categóricos (proporción)

En R, puedes crear un vector dicotómico que represente, por ejemplo, si una persona tiene o no tiene acceso a Internet en su hogar 

Vector categórico

```{r}
# Crear un vector categórico con "S" (Sí) y "N" (No)
acceso_internet <- c("S", "S", "N", "S", "N", "S", "S", "N", "S", "N", "S", "S", "S", "N", "N")


```


***Proporción: Función mean***

```{r}
# Crear un vector categórico con "S" (Sí) y "N" (No)
acceso_internet <- c("S", "S", "N", "S", "N", "S", "S", "N", "S", "N", "S", "S", "S", "N", "N")

# Calcular la proporción de "S" y "N"
prop_S2 <- mean(acceso_internet == "S")  # Proporción de "S"
prop_N2 <- mean(acceso_internet == "N")  # Proporción de "N"

```


Proporciones: 

```{r}
prop_S2
prop_N2
```

**Cuando se representa con (1 = Sí, 0 = No). Luego, puedes calcular la proporción de cada categoría solo calculando la media,

```{r}
# Crear un vector dicotómico (1 = Tiene acceso a Internet, 0 = No tiene)
y <- c(1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1,0, 1, 1, 1, 1)
```

Proporciones:

```{r}
prop_1 <- mean(acceso_internet == 1)  # Proporción de personas con acceso
prop_0 <- mean(acceso_internet == 0)  # Proporción de personas sin acceso

prop_1
prop_0
```




## Comandos `dpqr` para distribuciones de probabilidad

R proporciona cuatro funciones fundamentales para manejar distribuciones de probabilidad, se utilizan **comando + distribución***:  

+ **d**: Calcula la funcion de densidad de probabilidad (PDF) o la funcion de masa de probabilidad (PMF) para una distribucion.  
+ **p**: Calcula la funcion de distribucion acumulada (CDF), que nos dice la probabilidad de obtener un valor menor o igual a un punto dado.  
+ **q**: Calcula cuantiles o percentiles de la distribucion.  
+ **r**: Genera valores aleatorios a partir de la distribucion especificada.

### <font color="red"> d </font> (densidad): Funcion de Densidad de Probabilidad (PDF)


**La densidad de probabilidad** es una función matemática que describe la probabilidad relativa de que una variable aleatoria tome un valor específico dentro de un rango. En el caso de una distribución continua, como la normal, la probabilidad exacta de un solo punto es cero, por lo que en su lugar analizamos la densidad de probabilidad.


Ejemplo, creamos un vector numéricos:

```{r dnorm-example}

x <- seq(1, 5, length = 100)
x

```
```{r}
mean(x)
sd(x)
```

**Usamos la función d + la distribución** esta funcion devuelve la densidad de probabilidad en un punto especifico de la distribucion normal estandar. Nos dice **que tan probable es que un valor especifico ocurra**. Obtendremos las probabilidades para cada valor de x:

```{r}
#Aquí se utiliza la función d:

densidad <- dnorm(x, mean = 3 , sd = 1)
densidad

```

Graficar la densidad (probabilidad para cada valor de x):

```{r}
plot(x, densidad, type = "l", col = "blue", main = "Densidad de Probabilidad Normal",
     ylab = "Densidad", xlab = "Valores")
```



En el grafico, los valores cercanos a la media (0) tienen mayor probabilidad.


### <font color="red"> p </font> (probabilidad acumulada): Funcion de Distribucion Acumulada: 

Esta funcion devuelve la **probabilidad acumulada** de que un valor sea menor o igual a un punto dado.  


```{r}
#Probabilidad acumulada Z hasta 1.96
pnorm(1.96, mean=0, sd=1)
```

La probabilidad acumulada hasta que Z valga 1.96 es del 0.975.
Recuerde que estamos hablando de una distribución Z porque usamos la función p + norm (normal) con media = o y desviación = 1.

Si `pnorm(1.96, mean=0, sd=1)` da 0.975, significa que el 97.5% de los valores en una normal estandar son menores a 1.96 en otras palabras.


### <font color="red"> q </font> (cuartiles - valores de la variable x): Cuantiles o Percentiles
Esta funcion devuelve el valor **correspondiente a un percentil dado**, no aroja probabilidad, si no, el valor que tomaría X de acuerdo a la posición percentil.

Ejemplo:

```{r qnorm-example}

qnorm(0.975, mean = 0, sd = 1)
 
```

::: note

Note que esta función hace lo contrario a la anterior, ***Le ingresamos una probabilidad y nos arroja el valor de x, en este caso Z***
:::


### <font color="red"> r </font> (ramdom values): Generacion de Valores Aleatorios

Esta funcion genera valores aleatorios de una distribucion con los parametros dados, en este caso normal:


```{r rnorm-example}
set.seed(123) # Para reproducibilidad, para que se generen siempre los mismos valores, si no se usa, cada vez que ejecute las líneas de código, se crearán valores aleatorios nuevos.

datos = rnorm(100, mean = 0, sd = 1)
datos

```

***Se crearon 100 números aleatorios que siguen una distribución normal estándar.***


::: warning

set.seed() es una función en R que establece una semilla aleatoria para la generación de números pseudoaleatorios. Esto significa que garantiza que los resultados de cálculos aleatorios sean reproducibles cada vez que se ejecuta el código. **Si no se fija una semilla con set.seed(), cada vez que ejecutes el código obtendrás diferentes valores aleatorios.**
:::


```{r}
hist(datos, breaks = 30, col = "lightblue", main = "Muestra Aleatoria de distribución Normal",
     xlab = "Valores")
```

Aqui generamos 1000 valores aleatorios de una normal estandar y los visualizamos en un histograma.




---


## Distribuciones de probabilidad discretas

A continuacion, exploramos tres distribuciones discretas: **Bernoulli, Binomial y Poisson**.


### Distribucion de Bernoulli

La distribucion de Bernoulli modela experimentos con solo dos posibles resultados: **exito (1) o fracaso (0)**. La funcion de masa de probabilidad (PMF) es:

\[
P(X = x) = p^x (1-p)^{1-x}, \quad x \in \{0,1\}
\]


```{r bernoulli}

p <- 0.5  # Probabilidad de exito
x <- c(0, 1)

densidad_bernoulli <- dbinom(x, size = 1, prob = p)

barplot(densidad_bernoulli, names.arg = x, col = "steelblue",
        main = "Distribucion de Bernoulli", ylab = "Probabilidad", xlab = "Valores")
```


### Distribucion Binomial

La distribucion binomial modela el numero de exitos en `n` ensayos independientes de Bernoulli con probabilidad `p`. Su PMF es:

\[
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}, \quad k = 0,1,\dots,n
\]


```{r binomial}
 
densidad_binomial <- dbinom(0:10, size = 10, prob = 0.5) # size = número de ensayos y prob = Probabilidad de exito

barplot(densidad_binomial, names.arg = 0:10, col = "steelblue",
        main = "Distribucion Binomial", ylab = "Probabilidad", xlab = "Numero de exitos")
```


## Distribuciones de probabilidad continuas

### Distribucion Normal

La distribucion normal es una de las mas utilizadas en estadistica debido a su presencia en fenomenos naturales y cientificos. Se caracteriza por dos parametros:
- **Media (`mu`)**: Indica el centro de la distribucion.
- **Desviacion estandar (`sigma`)**: Define la dispersion de los datos.

La funcion de densidad de probabilidad para la distribucion normal es:

\[ f(x) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\frac{(x-\mu)^2}{2\sigma^2}} \]

En R podemos visualizarla de la siguiente manera:

```{r normal}

x <- seq(4, 8, length = 100) #Crear una secuencia de 100 números del -4 al 4
x

```

```{r}

densidad <- dnorm(x, mean = 6, sd = 0.5) #obtener las densidades (p) de cada número para la distribución Normal estandar y guardarlos en el objeto "densidad"
densidad

```

```{r}
plot(x, densidad, type = "l", col = "blue", main = "Distribucion Normal",
     ylab = "Densidad", xlab = "Valores")
```


### Distribucion Normal Estandar

Es un caso especial de la normal con media 0 y desviacion estandar 1.

```{r normal-estandar}

x <- seq(-4, 4, length = 100)

densidad <- dnorm(x, mean = 0, sd = 1)

```

```{r}
plot(x, densidad, type = "l", col = "red", main = "Densidad de la distribución Normal Estandar",
     ylab = "Densidad", xlab = "Valores")
```


### Distribucion t de Student

Esta distribucion se utiliza cuando el tamano de la muestra es pequeno y la varianza poblacional es desconocida. Su funcion de densidad es:

\[ f(t) = \frac{\Gamma((v+1)/2)}{\sqrt{v\pi} \Gamma(v/2)} \left( 1 + \frac{t^2}{v} \right)^{-(v+1)/2} \]

donde \( v \) es el numero de grados de libertad.

```{r t-student}

x <- seq(-4, 4, length = 100)

densidad_t <- dt(x, df = 10) #df significa: Grados de libertad

```


```{r}
plot(x, densidad_t, type = "l", col = "green", main = "Distribucion t de Student",
     ylab = "Densidad", xlab = "Valores")
```


***Los grados de libertad en la distribución t:***

Para visualizar la convergencia de la distribucion t a la normal estandar a medida que aumentan los grados de libertad, graficamos ambas en la misma figura.

```{r}

x <- seq(-4, 4, length = 100)

# Definir los grados de libertad
grados_libertad <- c(1, 5, 28)
colores <- c("red", "green", "orange")

```

Graficando en comparación con la distribución Normal Estándar:

```{r t-vs-normal}

# Graficar la distribucion normal estandar
plot(x, dnorm(x, mean = 0, sd = 1), type = "l", col = "black", lwd = 2,
     main = "Comparacion entre la Distribucion t y la Normal Estandar",
     ylab = "Densidad", xlab = "Valores", ylim = c(0, 0.45))

# Agregar las distribuciones t con diferentes grados de libertad
for (i in 1:length(grados_libertad)) {
  lines(x, dt(x, df = grados_libertad[i]), col = colores[i], lwd = 2)
}

# Agregar una leyenda
legend("topright", legend = c("Normal Estandar", paste("t (df=", grados_libertad, ")")),
       col = c("black", colores), lwd = 2)
```

### Distribucion Chi-cuadrado
Esta distribucion se usa en pruebas de hipotesis y analisis de varianza. Se obtiene como la suma de los cuadrados de \( k \) variables aleatorias normales estandar.

Su funcion de densidad es:
\[ f(x) = \frac{x^{(k/2)-1} e^{-x/2}}{2^{k/2} \Gamma(k/2)} \]

```{r chi-cuadrado}

x <- seq(0, 20, length = 100)

densidad_chi2 <- dchisq(x, df = 5) #df significa grados de libertad

plot(x, densidad_chi2, type = "l", col = "purple", main = "Distribucion Chi-cuadrado",
     ylab = "Densidad", xlab = "Valores")
```

### Distribucion F

Se usa para comparar varianzas en pruebas de hipotesis. Es la razon de dos distribuciones Chi-cuadrado divididas por sus respectivos grados de libertad:

\[ F = \frac{(\chi^2_{df1} / df1)}{(\chi^2_{df2} / df2)} \]

```{r f-distribucion}

x <- seq(0, 5, length = 100)
densidad_f <- df(x, df1 = 5, df2 = 10) #df1 y df2 son lso grados de libertad


plot(x, densidad_f, type = "l", col = "orange", main = "Distribucion F",
     ylab = "Densidad", xlab = "Valores")
```



---


## Distribuciones muestrales: Simulaciones de múltiples muestras

Las distribuciones muestrales describen la variabilidad de un estadístico muestral (como la media, proporción o varianza) a través de diferentes muestras tomadas de una misma población.  

::: warning

**Diferencia clave**  
Mientras que una distribución de probabilidad describe cómo se comporta una sola variable aleatoria,
Una distribución muestral describe **cómo varía un estadístico**, como la media muestral, al tomar muchas muestras.  
:::


### Simulación de la distribución muestral de la media
```{r}

set.seed(123) #Sembrar semilla para que solo se generen valores aletorios una vez
medias <- numeric(1000)  # Vector vacío para guardar las medias

```

Se crean 1000 muestras de 30 observaciones cada, cada una a partir de una distribución normal com media 50 y desviación estándar de 10.
Luego, se guardan todas las medias muestrales.

```{r} 

#Esto es un blucle: acción repetitiva:

for (i in 1:1000) { #Para cada i desde 1 hasta 1000, generar una muestra a partir de una distribución normal
  muestra <- rnorm(30, mean = 50, sd = 10)  # Cada muestra tiene 30 observaciones y sigue distribución normal con media 50 y desvición estándar de 10
  medias[i] <- mean(muestra)  # Guardamos las medias muestrales en el vector medias
}

head(medias) #Mostrar las primeras medias generadas

```

Graficando la media de cada muestra en un histograma:

```{r}

hist(medias, breaks = 30, col = "lightblue", probability = TRUE,
     main = "Distribucion Muestral de la Media",
     xlab = "Media Muestral")
lines(density(medias), col = "red", lwd = 2)  # Agregamos la curva de densidad

```


La forma de campana describe cómo el histograma se aproxima a una distribución normal.

### Simulación de la distribucion Muestral de la Varianza

La distribucion de la varianza muestral sigue una **distribucion chi-cuadrado**. 

Ahora vamos a generar nuevamente 1000 muestras de tamaño 30 que sigan distribución normal con media 50 y desviación estándar de 30:

```{r simulacion-varianza}

set.seed(123) #Semilla para que no se generen valores diferentes cada vez que se corra el código
varianzas <- numeric(1000) # Crear vector númerico con el tamaño de las n muestras

```

```{r}

#Crear en bucle las 1000 muestras y calcular la varianza de cada una

for (i in 1:1000) {
  muestra <- rnorm(30, mean = 50, sd = 10) #generar muestras normales con media 50 y desviación estándar de 10
  varianzas[i] <- var(muestra) #Guardar las varianzas de cada muestra.
}

```


Graficando en un histograma las 1000 varianzas calculadas (una para cada muestra):
```{r}

hist(varianzas, breaks = 30, col = "pink", probability = TRUE,
     main = "Distribucion Muestral de la Varianza",
     xlab = "Varianza Muestral")
lines(density(varianzas), col = "red", lwd = 2)

```






Se puede apreciar la forma muy similar a la distribución chi cuadrada.


### Simulación de la distribucion Muestral de la Proporción

Si tomamos muestras de una población binomial, la proporcion de "exitos" en cada muestra sigue una distribucion aproximadamente normal si el tamaño de la muestra es suficientemente grande.

```{r simulacion-proporcion}

set.seed(123)
poblacion <- rbinom(10000, size = 1, prob = 0.4)  # Poblacion binaria con p = 0.4
proporciones <- numeric(1000)# Crear vector númerico con el tamaño de las n muestras

```


Se crean 1000 muestras, cada una a partir de una distribución binomial com probabilidad de éxito de 0.4. Luego, se guardan todas las proporciones de éxito muestrales.

```{r}
for (i in 1:1000) {
  muestra <- sample(poblacion, 50)
  proporciones[i] <- mean(muestra) #Calcular la proporción de exitos en cada muestra
}
```

```{r}

hist(proporciones, breaks = 30, col = "lightgreen", probability = TRUE,
     main = "Distribucion Muestral de la Proporcion",
     xlab = "Proporcion Muestral")
lines(density(proporciones), col = "red", lwd = 2)

```


Se puede apreciar como la distribución binomial se acerca mucho a la distribución normal.